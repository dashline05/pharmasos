---
import Layout from "@/layouts/Base.astro";
import { getCollection } from 'astro:content';
import type { CollectionEntry } from 'astro:content';
import { LOCALES } from "@/i18n";

export const prerender = true;

const validLanguages = ['en', 'fr', 'ar'] as const;
type ValidLanguage = typeof validLanguages[number];

export function getStaticPaths() {
  const posts = await getCollection('blog');
  return validLanguages.map(lang => ({
    params: { lang }
  }));
}

const { lang } = Astro.params;
const currentLang = validLanguages.includes(lang as ValidLanguage) ? lang as ValidLanguage : 'fr';

const translations = {
  title: {
    fr: "Article",
    en: "Post",
    ar: "مقال"
  }
} as const;

type BlogEntry = CollectionEntry<'blog'>;

interface Props {
  entry: BlogEntry;
}

const { entry } = Astro.props;
---

<Layout title={translations.title[currentLang]}>
  <div class="blog-post">
    <h1>{translations.title[currentLang]}</h1>
    {entry.data.description && <p>{entry.data.description}</p>}
  </div>
</Layout>